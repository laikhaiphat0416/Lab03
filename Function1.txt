Phat's code for function 1
